<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>
<script type="text/javascript"
	src="https://code.jquery.com/jquery-3.5.0.min.js"></script>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js">
	
</script>
<script type="text/javascript">
	// 1. 지하철 일일 이용객 비교 
	$(function() {
		$.getJSON("http://192.168.1.33/Project_subway/GetSubJSON", function(sd) {
			var user2019 = [];
			var user2020 = [];
			$.each(sd, function(i, s) {
				user2019[i] = {label : s.day, y : s.y2019 * 1};
				user2020[i] = {label : s.day, y : s.y2020 * 1};
			});
			var chart = new CanvasJS.Chart("chartContainer1", {
				animationEnabled : true,
				exportEnabled : true,
				theme : "light1", // "light1", "light2", "dark1", "dark2"
				title : {text : "지하철 일별 이용객 수"},
				data : [ {name : "2019", //Shows y value on all Data Points
						type : "line", //change type to bar, line, area, pie, etc
						showInLegend: true, 
						dataPoints : user2019
				}, {name : "2020", //Shows y value on all Data Points
					type : "line", //change type to bar, line, area, pie, etc
					showInLegend: true, 
					dataPoints : user2020
				}]
			});
			chart.render();
		});
	});
	// 2. 평일 주말 비교
	$(function() {
		$.getJSON("http://192.168.1.33/Project_subway/GetSubWJSON", function(sd) {
			var wd = [];
			var wk = [];
			$.each(sd, function(i, s) {
				wd[i] = {label : s.year, y : parseInt(s.weekday * 1)};
				wk[i] = {label : s.year, y : parseInt(s.weekend * 1)};
			});
			var chart = new CanvasJS.Chart("chartContainer2", {
				animationEnabled : true,
				exportEnabled : true,
				theme : "light1", // "light1", "light2", "dark1", "dark2"
				title : {
					text : "지하철 평일/주말 일평균 이용객 수"
				},
				data : [ {
					name : "평일",
					type : "column", 
					showInLegend: true, 
					dataPoints : wd
				}, {
					name : "주말", //Shows y value on all Data Points
					type : "column", //change type to bar, line, area, pie, etc
					showInLegend: true, 
					dataPoints : wk
				} ]
			});
			chart.render();
		});

	});
	// 3. 지하철 역별 감소폭 top10 감소폭/율 그래프
	$(function() {
		$.getJSON("http://192.168.1.33/Project_subway/GetSubSJSON", function(sd) {
			var gab = [];
			var per = [];
			$.each(sd, function(i, s) {
				gab[i] = {label : s.station, y : s.gab * 1};
				per[i] = {label : s.station, y : s.per * 100};
			});
			var chart = new CanvasJS.Chart("chartContainer3", {
				animationEnabled : true,
				exportEnabled : true,
				theme : "light1", // "light1", "light2", "dark1", "dark2"
				title : {
					text : "전년 대비 지하철 이용객 감소폭 Top10"
				},
				axisY: {
					lineColor: "#4F81BC",
					tickColor: "#4F81BC",
					labelFontColor: "#4F81BC"
				},
				axisY2: {
					suffix: "%",
					lineColor: "#C0504E",
					tickColor: "#C0504E",
					labelFontColor: "#C0504E"
				},
				data : [ {
					type : "column", //change type to bar, line, area, pie, etc
					dataPoints : gab
				} ]
			});
			chart.render();
			createPareto();	
			 
			function createPareto(){
				var yTotal = 0;
				for(var i = 0; i < chart.data[0].dataPoints.length; i++)
					yTotal += chart.data[0].dataPoints[i].y;
				theme : "light1"
				chart.addTo("data",{type:"line", yValueFormatString: "0.##\"%\"",  dataPoints: per});
				chart.data[1].set("axisYType", "secondary", false);
				chart.axisY[0].set("maximum", 8000000);
				chart.axisY2[0].set("maximum", 100);
			}
			
		});

	});
</script>
</head>
<body>
	<div align = "center" id="chartContainer1" style="height: 300px; width: 80%;"></div>
	<br> <blockquote>- 2019년 설날(2/5)과 2020년 설날(1/25)로 인한 이용객 차이 배제 
	<br> - 전년대비 기간 총 이용객은 388,043,418명 감소, 감소율은 24.4%
	<br> - 1월 20일 국내 첫 확진자 이후, 2월 23일 국가 위기단계 최고 수준 '심각'격상 후 감소폭이 급격히 커진후 유지</blockquote>
	<br>
	<br>
	<br>
	<div id="chartContainer2" style="height: 300px; width:  800px;"></div>
	<br> - 전년 대비 평일 이용객은 21.4% 감소, 주말은 34.2% 감소
	<br>
	<br>
	<br>
	<div id="chartContainer3" style="height: 300px; width:  800px;"></div>
	<br> - 전년 대비 역별 이용객 감소폭 평균은 760,283명 이며, 감소율 평균은 23.3%로 대중교통 허브, 관광지 중심 이용객수 크게 감소	
	<br> - 2020년 새로 생긴 역 이용객은 비교에서 제외
	<br> 
	<br> 
	<br> 
</body>
</html>